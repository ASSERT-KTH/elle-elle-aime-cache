{
    "generation": "/**\n * @param contentTypeSer Optional explicit type information serializer\n *    to use for contained values (only used for properties that are\n *    of container type)\n */\n@SuppressWarnings(\"deprecation\")\nprotected BeanPropertyWriter buildWriter(SerializerProvider prov,\n        BeanPropertyDefinition propDef, JavaType declaredType, JsonSerializer<?> ser,\n        TypeSerializer typeSer, TypeSerializer contentTypeSer,\n        AnnotatedMember am, boolean defaultUseStaticTyping)\n    throws JsonMappingException\n{\n    JavaType serializationType = findSerializationType(am, defaultUseStaticTyping, declaredType);\n\n    if (contentTypeSer != null) {\n        if (serializationType == null) {\n            serializationType = declaredType;\n        }\n        JavaType ct = serializationType.getContentType();\n        if (ct == null) {\n            throw new IllegalStateException(\"Problem trying to create BeanPropertyWriter for property '\" +\n                    propDef.getName() + \"' (of type \" + _beanDesc.getType() + \"); serialization type \" + serializationType + \" has no content\");\n        }\n        serializationType = serializationType.withContentTypeHandler(contentTypeSer);\n        ct = serializationType.getContentType();\n    }\n\n    Object valueToSuppress = null;\n    boolean suppressNulls = false;\n\n    JsonInclude.Value inclV = _defaultInclusion.withOverrides(propDef.findInclusion());\n    JsonInclude.Include inclusion = inclV.getValueInclusion();\n    if (inclusion == JsonInclude.Include.USE_DEFAULTS) {\n        inclusion = JsonInclude.Include.ALWAYS;\n    }\n\n    JavaType actualType = (serializationType == null) ? declaredType : serializationType;\n\n    switch (inclusion) {\n        case NON_DEFAULT:\n            valueToSuppress = getPropertyDefaultValue(propDef.getName(), am, actualType);\n            if (valueToSuppress == null) {\n                suppressNulls = true;\n            } else if (valueToSuppress.getClass().isArray()) {\n                valueToSuppress = ArrayBuilders.getArrayComparator(valueToSuppress);\n            }\n            break;\n        case NON_ABSENT:\n            suppressNulls = true;\n            if (declaredType.isContainerType()) {\n                valueToSuppress = BeanPropertyWriter.MARKER_FOR_EMPTY;\n            }\n            break;\n        case NON_EMPTY:\n            suppressNulls = true;\n            valueToSuppress = BeanPropertyWriter.MARKER_FOR_EMPTY;\n            break;\n        case NON_NULL:\n            suppressNulls = true;\n            if (declaredType.isContainerType() && !_config.isEnabled(SerializationFeature.WRITE_EMPTY_JSON_ARRAYS)) {\n                valueToSuppress = BeanPropertyWriter.MARKER_FOR_EMPTY;\n            }\n            break;\n        case ALWAYS:\n            // we may still want to suppress empty collections, as per [JACKSON-254]:\n            if (declaredType.isContainerType() && !_config.isEnabled(SerializationFeature.WRITE_EMPTY_JSON_ARRAYS)) {\n                valueToSuppress = BeanPropertyWriter.MARKER_FOR_EMPTY;\n            }\n            break;\n    }\n\n    BeanPropertyWriter bpw = new BeanPropertyWriter(propDef, am, _beanDesc.getClassAnnotations(),\n            declaredType, ser, typeSer, serializationType, suppressNulls, valueToSuppress);\n\n    Object serDef = _annotationIntrospector.findNullSerializer(am);\n    if (serDef != null) {\n        bpw.assignNullSerializer(prov.serializerInstance(am, serDef));\n    }\n\n    NameTransformer unwrapper = _annotationIntrospector.findUnwrappingNameTransformer(am);\n    if (unwrapper != null) {\n        bpw = bpw.unwrappingWriter(unwrapper);\n    }\n\n    return bpw;\n}",
    "exact_match": false,
    "ast_match": false,
    "compile": true,
    "test": false
}