{
    "generation": "void tryMinimizeExits(Node n, int exitType, String labelName) {\n\n    // Just an 'exit'.\n    if (matchingExitNode(n, exitType, labelName)) {\n        NodeUtil.removeChild(n.getParent(), n);\n        compiler.reportCodeChange();\n        return;\n    }\n\n    // Just an 'if'.\n    if (n.isIf()) {\n        Node ifBlock = n.getFirstChild().getNext();\n        tryMinimizeExits(ifBlock, exitType, labelName);\n        Node elseBlock = ifBlock.getNext();\n        if (elseBlock != null) {\n            tryMinimizeExits(elseBlock, exitType, labelName);\n        }\n        return;\n    }\n\n    // Handle 'try/catch/finally' with special care for breaks in finally blocks\n    if (n.isTry()) {\n        Node tryBlock = n.getFirstChild();\n        tryMinimizeExits(tryBlock, exitType, labelName);\n        \n        Node allCatchNodes = NodeUtil.getCatchBlock(n);\n        if (NodeUtil.hasCatchHandler(allCatchNodes)) {\n            Preconditions.checkState(allCatchNodes.hasOneChild());\n            Node catchNode = allCatchNodes.getFirstChild();\n            Node catchCodeBlock = catchNode.getLastChild();\n            tryMinimizeExits(catchCodeBlock, exitType, labelName);\n        }\n        \n        if (NodeUtil.hasFinally(n)) {\n            Node finallyBlock = n.getLastChild();\n            // Check for breaks in finally block\n            boolean hasBreakInFinally = hasBreakInFinallyBlock(finallyBlock, labelName);\n            if (!hasBreakInFinally) {\n                tryMinimizeExits(finallyBlock, exitType, labelName);\n            }\n        }\n    }\n\n    // Just a 'label'.\n    if (n.isLabel()) {\n        Node labelBlock = n.getLastChild();\n        tryMinimizeExits(labelBlock, exitType, labelName);\n    }\n\n    // SWITCH statement handling (implementing the TODO)\n    if (n.isSwitch()) {\n        Node caseNodes = n.getFirstChild().getNext();\n        for (Node caseNode = caseNodes.getFirstChild(); caseNode != null; caseNode = caseNode.getNext()) {\n            if (caseNode.isCase() || caseNode.isDefaultCase()) {\n                Node block = caseNode.getLastChild();\n                tryMinimizeExits(block, exitType, labelName);\n            }\n        }\n    }\n\n    // The rest assumes a block with at least one child, bail on anything else.\n    if (!n.isBlock() || n.getLastChild() == null) {\n        return;\n    }\n\n    // Multiple if-exits can be converted in a single pass.\n    // Convert \"if (blah) break;  if (blah2) break; other_stmt;\" to\n    // become \"if (blah); else { if (blah2); else { other_stmt; } }\"\n    // which will get converted to \"if (!blah && !blah2) { other_stmt; }\".\n    for (Node c : n.children()) {\n\n        // An 'if' block to process below.\n        if (c.isIf()) {\n            Node ifTree = c;\n            Node trueBlock, falseBlock;\n\n            // First, the true condition block.\n            trueBlock = ifTree.getFirstChild().getNext();\n            falseBlock = trueBlock.getNext();\n            tryMinimizeIfBlockExits(trueBlock, falseBlock, ifTree, exitType, labelName);\n\n            // Now the else block.\n            // The if blocks may have changed, get them again.\n            trueBlock = ifTree.getFirstChild().getNext();\n            falseBlock = trueBlock.getNext();\n            if (falseBlock != null) {\n                tryMinimizeIfBlockExits(falseBlock, trueBlock, ifTree, exitType, labelName);\n            }\n        }\n\n        if (c == n.getLastChild()) {\n            break;\n        }\n    }\n\n    // Now try to minimize the exits of the last child, if it is removed\n    // look at what has become the last child.\n    for (Node c = n.getLastChild(); c != null; c = n.getLastChild()) {\n        tryMinimizeExits(c, exitType, labelName);\n        // If the node is still the last child, we are done.\n        if (c == n.getLastChild()) {\n            break;\n        }\n    }\n}\n\n// Helper method to check for breaks in finally blocks\nprivate boolean hasBreakInFinallyBlock(Node finallyBlock, String labelName) {\n    if (finallyBlock == null) {\n        return false;\n    }\n    for (Node child : finallyBlock.children()) {\n        if (child.isBreak()) {\n            if (labelName == null || (child.getFirstChild() != null && child.getFirstChild().getString().equals(labelName))) {\n                return true;\n            }\n        } else if (child.isBlock()) {\n            if (hasBreakInFinallyBlock(child, labelName)) {\n                return true;\n            }\n        }\n    }\n    return false;\n}",
    "exact_match": false,
    "ast_match": false,
    "compile": true,
    "test": false
}