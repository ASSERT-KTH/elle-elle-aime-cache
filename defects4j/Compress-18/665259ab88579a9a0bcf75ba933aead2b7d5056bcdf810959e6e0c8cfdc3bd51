{
    "generation": "/**\n * Writes a PAX extended header with the given map as contents.\n * @since 1.4\n */\nvoid writePaxHeaders(String entryName,\n                     Map<String, String> headers) throws IOException {\n    String name = \"./PaxHeaders.X/\" + stripTo7Bits(entryName);\n        // TarEntry's constructor would think this is a directory\n        // and not allow any data to be written\n    if (name.length() >= TarConstants.NAMELEN) {\n        name = name.substring(0, TarConstants.NAMELEN - 1);\n    }\n    TarArchiveEntry pex = new TarArchiveEntry(name,\n                                              TarConstants.LF_PAX_EXTENDED_HEADER_LC);\n\n    StringWriter w = new StringWriter();\n    int totalLength = 0; // Track the total length of the data\n    for (Map.Entry<String, String> h : headers.entrySet()) {\n        String key = h.getKey();\n        String value = h.getValue();\n        int len = key.length() + value.length()\n            + 3 /* blank, equals and newline */\n            + 2 /* guess 9 < actual length < 100 */;\n        String line = len + \" \" + key + \"=\" + value + \"\\n\";\n        int actualLength = line.getBytes(CharsetNames.UTF_8).length;\n        while (len!= actualLength) {\n            // Adjust for cases where length < 10 or > 100\n            // or where UTF-8 encoding isn't a single octet\n            // per character.\n            // Must be in loop as size may go from 99 to 100 in\n            // first pass so we'd need a second.\n            len = actualLength;\n            line = len + \" \" + key + \"=\" + value + \"\\n\";\n            actualLength = line.getBytes(CharsetNames.UTF_8).length;\n        }\n        w.write(line);\n        totalLength += actualLength; // Update the total length\n    }\n    // Add the length of the final newline (if any) and the padding to 0\n    if (w.getBuffer().length() > 0) {\n        totalLength += 1; // For the final newline\n        totalLength = (totalLength + 511) / 512 * 512; // Round up to the nearest 512 byte block\n    }\n    pex.setSize(totalLength); // Set the correct size\n    putArchiveEntry(pex);\n    byte[] data = w.toString().getBytes(CharsetNames.UTF_8);\n    write(data);\n    if (data.length < totalLength) { // Write padding if necessary\n        byte[] padding = new byte[totalLength - data.length];\n        write(padding);\n    }\n    closeArchiveEntry();\n}",
    "exact_match": false,
    "ast_match": false,
    "compile": true,
    "test": false
}