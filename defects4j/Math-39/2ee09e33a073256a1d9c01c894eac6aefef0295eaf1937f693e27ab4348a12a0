{
    "generation": "/** {@inheritDoc} */\n@Override\npublic void integrate(final ExpandableStatefulODE equations, final double t)\n    throws MathIllegalStateException, MathIllegalArgumentException {\n\n    sanityChecks(equations, t);\n    setEquations(equations);\n    final boolean forward = t > equations.getTime();\n\n    // create some internal working arrays\n    final double[] y0  = equations.getCompleteState();\n    final double[] y = y0.clone();\n    final int stages = c.length + 1;\n    final double[][] yDotK = new double[stages][y.length];\n    final double[] yTmp    = y0.clone();\n    final double[] yDotTmp = new double[y.length];\n\n    // set up an interpolator sharing the integrator arrays\n    final RungeKuttaStepInterpolator interpolator = (RungeKuttaStepInterpolator) prototype.copy();\n    interpolator.reinitialize(this, yTmp, yDotK, forward,\n                              equations.getPrimaryMapper(), equations.getSecondaryMappers());\n    interpolator.storeTime(equations.getTime());\n\n    // set up integration control objects\n    stepStart         = equations.getTime();\n    double  hNew      = 0;\n    boolean firstTime = true;\n    initIntegration(equations.getTime(), y0, t);\n\n    // **BUG FIX**: ensure initial step size is not too large\n    if (firstTime) {\n        final double[] scale = new double[mainSetDimension];\n        if (vecAbsoluteTolerance == null) {\n            for (int i = 0; i < scale.length; ++i) {\n                scale[i] = scalAbsoluteTolerance + scalRelativeTolerance * FastMath.abs(y[i]);\n            }\n        } else {\n            for (int i = 0; i < scale.length; ++i) {\n                scale[i] = vecAbsoluteTolerance[i] + vecRelativeTolerance[i] * FastMath.abs(y[i]);\n            }\n        }\n        final double initialStepSize = FastMath.min(FastMath.abs(t - equations.getTime()), 1.0);\n        hNew = initializeStep(forward, getOrder(), scale,\n                              stepStart, y, yDotK[0], yTmp, yDotK[1]);\n        hNew = FastMath.min(hNew, initialStepSize); // **BUG FIX**\n        firstTime = false;\n    }\n\n    // main integration loop (rest of the function remains unchanged)\n   ...\n}",
    "exact_match": false,
    "ast_match": false,
    "compile": false,
    "test": false
}